{{/* Tag Filter List */}}
<div class="mb-5">
  <div class="d-flex flex-wrap justify-content-center gap-2">
    {{/* All button (Homepage link) */}}
    <a href="{{ .Site.Home.RelPermalink }}" class="btn btn-outline-primary {{ if .IsHome }}active{{ end }}">
      <i class="fa-solid fa-grid-2 me-2"></i>
      {{ i18n "all_topics" | default "All" }}
    </a>

    {{/* Build a sorted list of tags by extensions count */}}
    {{- $tagList := slice }}
    {{- range .Site.Taxonomies.tags }}
      {{/* Count only pages with "extensions" category */}}
      {{- $extensionsCount := 0 }}
      {{- range .Pages }}
        {{- if in .Params.categories "extensions" }}
          {{- $extensionsCount = add $extensionsCount 1 }}
        {{- end }}
      {{- end }}
      {{- if gt $extensionsCount 0 }}
        {{- $tagList = $tagList | append (dict "Page" .Page "Count" $extensionsCount) }}
      {{- end }}
    {{- end }}

    {{/* Sort by count descending */}}
    {{- range sort $tagList "Count" "desc" }}
      {{- $isActive := false }}
      {{- if $.Param "term" }}
        {{- if eq $.Param "term" .Page.Title }}
          {{- $isActive = true }}
        {{- end }}
      {{- end }}
      <a href="{{ .Page.RelPermalink }}" class="btn btn-outline-primary {{ if $isActive }}active{{ end }}">
        {{ .Page.Title }}
        <span class="badge bg-primary text-white ms-1">{{ .Count }}</span>
      </a>
    {{- end }}
  </div>
</div>
